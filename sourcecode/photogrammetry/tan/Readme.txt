This code implements Robby Tan's sepcular estimation method.
The input image should be 8 bit, and the example can be:

I = TanRGBDespec(I);